<div th:insert="~{header.html}"></div>
<div th:insert="~{sidebar.html}"></div>
<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet">

    <title th:text="${title}"></title>
    <style>
        .mb-2 {
            margin-top: -550px;
            margin-left: 300px;
            margin-right: 200px;

        }


    </style>
</head>
<body>
<!-- Add this section above your existing table -->


<div class="content container-fluid ">

    <div class="page-name mb-2">

        <div class="container pb-4 my-4 border mx-auto">

            <div class="container">
                <form id="departmentForm">
                    <select id="departmentSelect" class="form-select" aria-label="Select Department">
                        <option value="" selected>Select Department</option>
                        <option th:each="dept : ${department}" th:value="${dept.id}" th:text="${dept.name}">${dept.name}</option>
                    </select>
                    <button type="button" class="btn btn-primary" onclick="getEmployees()">Show Employees</button>
                </form>


                <table class="table table-striped table-success">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Contact</th>
                        <th>Email</th>
                        <th>Join Date</th>
                        <th>Gender</th>
                        <th>Department</th>
                        <th>Salary</th>
                        <th>Action</th>

                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="employee : ${employeeList}">
                        <td th:text="${employee.id}"></td>
                        <td th:text="${employee.name}"></td>
                        <td th:text="${employee.contact}"></td>
                        <td th:text="${employee.email}"></td>
                        <td th:text="${employee.joiningDate}"></td>
                        <td th:text="${employee.gender}"></td>
                        <td th:text="${employee.department.name}"></td>
                        <td th:text="${employee.salary}"></td>
                        <td>
                            <a class="btn btn-danger" th:href="@{'/employee/delete/'+${employee.id}}">
                                Delete
                            </a>
                            <a class="btn btn-warning" th:href="@{'/employee/edit/'+${employee.id}}">
                                Update
                            </a>


                        </td>

                    </tr>

                    </tbody>


                </table>
            </div>
        </div>
    </div>
</div>


<!-- Modify the existing script -->
<script>
    function getEmployees() {
        var selectedDepartmentId = document.getElementById("departmentSelect").value;

        if (selectedDepartmentId !== "") {
            // Use AJAX to fetch employees based on the selected department
            // This is a simplified example, you may want to use a more advanced approach (e.g., Fetch API or jQuery AJAX)
            window.location.href = "/employee/department/" + selectedDepartmentId;
        } else {
            // If no department is selected, redirect to the default employee list page
            window.location.href = "/employee";
        }
    }
</script>

</script>
</body>
</html>